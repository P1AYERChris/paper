**2024年青海省重大专项**

"青海省绿电溯源与异构算力一体化关键技术研究与应用"

课题月度工作进展报告

2025-04

**课题编号**：2024-GX-A3-04(课题4)

**课题名称：**算力互联网应用研究

**课题负责人：**黄建强

**课题承担单位：**青海大学

**一. 工作内容及进展（重点内容）**

**4. 子课题四---"垂直领域大模型示范研究"工作内容及进展：**

现阶段进展主要涉及三个方面：因果掩膜优化、模型参数稀疏化和计算框架优化。在因果掩膜优化方面，已完成基于Granger因果检验的因果网络构建，通过相关性矩阵和p值筛选重要因果关系，设计了动态阈值算法和IMF分量因果特征掩膜，并在GNN-Transformer模型中引入稀疏化的因果注意力掩码。同时，开发了Hilbert-Huang变换（HHT）方法，结合IMF分量生成因果链用于模型输入。在模型参数稀疏化方面，已实现L2正则化和动态批量大小调整策略，通过早停和学习率调度优化训练效率。在计算框架优化方面，采用多进程并行处理和GPU加速实现高效计算，支持跨IMF分量的批处理优化，并为后续的ONNX导出预留了接口。此外，多模态融合模型集成了GNN、Transformer和LSTM特征路径，通过设计三模态融合层提升了模型的综合性能。这些工作显著提升了因果网络分析与多子模型集成系统的计算效率。

目前已实现因果网络预测模型架构、时空预测模型的构建、因果网络时间预测、因果网络空间预测，其在应用情况如图1～图4所示。经分析，基于Transformer架构的注意力机制，其时间预测精确，流域内日尺度单步预测，平均可靠性超过90%。将因果网络作为图卷积网络特征输入，不仅掌握关系空间信息，还充分捕捉数据空间分布趋势。

![](media/image28.png)![图表 AI
生成的内容可能不正确。](media/image2.png){width="2.7559055118110236in"
height="2.531496062992126in"}

（a）生态因子网络关系（颜色代表因果链强度）

（b）网络中节点特性（蓝色为出节点，红色为入节点）

图1 生态因子网络关系

![](media/image3.png){width="5.768055555555556in"
height="2.5868055555555554in"}

图2 时空预测模型

![图形用户界面 AI
生成的内容可能不正确。](media/image4.png){width="5.433070866141732in"
height="2.7357622484689412in"}

（a）生态变量（叶面积指数）

![图形用户界面, 图表 AI
生成的内容可能不正确。](media/image5.png){width="5.433070866141732in"
height="2.6891240157480314in"}

（b）水文变量（实际蒸发量）

![图形用户界面 AI
生成的内容可能不正确。](media/image4.png){width="5.433070866141732in"
height="2.7357622484689412in"}

（c）环境变量（土壤含水量）

图3 因果网络时间预测结果

![图表 AI
生成的内容可能不正确。](media/image6.png){width="5.768055555555556in"
height="1.9180555555555556in"}

实测 预测

（a）生态变量（土壤含水量）

![图形用户界面 AI
生成的内容可能不正确。](media/image7.png){width="5.768055555555556in"
height="1.9305555555555556in"}

实测 预测

（b）水文变量（径流量）

![图表 AI
生成的内容可能不正确。](media/image8.png){width="5.768055555555556in"
height="1.8965277777777778in"}

实测 预测

（c）环境变量（风速）

图4 因果网络空间预测结果

截至六月份，子课题四"垂直领域大模型示范研究"在因果掩膜优化、模型参数稀疏化、计算框架优化和多模态特征融合方面取得了进展：

1\. 因果掩膜优化：

完成基于Granger因果检验的因果网络构建，结合相关性矩阵和动态阈值算法筛选重要因果关系。

实现Hilbert-Huang变换（HHT）方法，生成IMF分量因果链并作为模型输入。

在GNN-Transformer模型中引入稀疏化的因果注意力掩码，进一步提升因果特征的多维度表达。

2\. 模型参数稀疏化：

实现L2正则化和动态批量大小调整策略，优化模型训练过程中的参数稀疏化处理。

通过早停和学习率调度策略显著提升训练效率，避免过拟合。

3\. 计算框架优化：

采用多进程并行处理和GPU加速实现高效数据处理，支持跨IMF分量的批处理优化。

构建Hilbert-Huang变换的因果链生成与特征融合，优化模型输入效率。

4\. 多模态特征融合：

构建三模态融合层（GNN、Transformer和LSTM），提升时空预测模型的精确度。

成功集成因果网络和多子模型，显著提高模型的综合性能。

**二. 成果产出**

暂无。

**三. 课题进展中遇到的问题及对策**

**4. 子课题四研究进展中遇到的问题及对策：**

1.因果掩膜优化问题：

在因果网络构建过程中，动态阈值算法的超参数敏感性较高，导致部分因果关系筛选结果不稳定。

Hilbert-Huang变换生成的IMF分量在数据噪声较高时分解效果不理想，影响因果链的生成质量。

2.模型训练问题：

动态批量大小调整策略在高维数据下引发显存占用波动，需进一步优化内存管理。

学习率衰减策略在长时间训练中未能充分适配所有数据集，导致部分迭代轮次效率较低。

3.计算框架问题：

多进程并行处理在跨IMF分量批处理时出现同步问题，影响计算速度和稳定性。

GPU加速在大规模数据训练中偶尔出现内存泄漏问题，需进一步优化显存管理。

4\. 模型融合问题：

模态融合层设计中存在权重分配不均的问题，导致某些模态特征未能充分参与最终预测。

**四、下一步工作计划**

**4. 子课题四下一步工作计划(2025.6.20-2025.7.20)：**

1.因果掩膜优化：

优化动态阈值算法，设计基于自适应参数的因果关系筛选机制。

提高Hilbert-Huang变换在噪声数据中的鲁棒性，进一步优化IMF分量生成方法。

2.模型训练优化：

重新设计动态批量大小调整策略，引入内存预分配机制以稳定显存占用。

针对长时间训练数据设计多阶段学习率衰减方案，提高训练效率。

3.计算框架优化：

优化多进程并行处理框架，采用分布式任务调度机制解决跨IMF分量批处理的同步问题。

修复GPU加速中的内存泄漏问题，增加显存监控功能。

4.模型融合优化：

调整三模态融合层权重分配策略，设计基于注意力机制的动态权重分配模型。

增强多模态特征交互能力，进一步提升时空预测模型的性能。

另外，根据项目组进度计划的要求，要尽快与其他课题组沟通合作，完成三江源大模型在平台上的部署与应用，主要涉及课题组内融合的高分辨率数据集应用、MPI并行程序改写、调用组件构建、初测计算资源需求等。

报告编制人：白小军

2025年4月20日
